!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,t,i){Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var i=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,i){var n,s;n=i(2);var a=i(4);s=n=n||{},"object"!=typeof n["default"]&&"function"!=typeof n["default"]||(s=n=n["default"]),"function"==typeof s&&(s=s.options),s.render=a.render,s.staticRenderFns=a.staticRenderFns,e.exports=n},function(e,t,i){var n,s;n=i(3);var a=i(5);s=n=n||{},"object"!=typeof n["default"]&&"function"!=typeof n["default"]||(s=n=n["default"]),"function"==typeof s&&(s=s.options),s.render=a.render,s.staticRenderFns=a.staticRenderFns,e.exports=n},function(e,t,i){"use strict";t["default"]={props:["channel","messages","members","connected"],data:function(){return{message:"",title:this.members.guest.nick,closable:!1,hourIntervals:{},blinkIntervals:{}}},methods:{send:function(){if(""==this.message)return!1;var e=this.message;this.$http.post("/chat/message",{channel:this.channel,message:e}),this.$parent.talks[this.channel].messages.push({content:e,type:"sent"}),this.message=""},activate:function(e){clearInterval(this.blinkIntervals[this.channel]),this.blinkIntervals[this.channel]=!1,e.find("input").focus()},load:function(){$(".ui-dialog-titlebar-minimize span").text(""),$(".ui-dialog-titlebar-maximize span").text(""),$(".ui-dialog-titlebar-restore span").text(""),$(".ui-dialog-titlebar-minimize").attr("title","Minimalizuj"),$(".ui-dialog-titlebar-maximize").attr("title","Maksymalizuj"),$(".ui-dialog-titlebar-restore span").attr("title","Przywróć"),$(".ui-dialog-titlebar-close").attr("title","Zamknij")},restore:function(){this.scroll()},beforeClose:function(){if(!this.closable)return!1},close:function(){clearInterval(this.hourIntervals[this.channel]),this.$parent.privateExit(this.channel,this.members.guest.id)},scroll:function(){$("#"+this.channel+" .messagebox").animate({scrollTop:$("#"+this.channel+" .messagebox")[0].scrollHeight},800)},blinkTitle:function(){var e=this.members.guest.gender?"napisała":"napisał";newMessageTitleAlert(this.members.guest.nick+" "+e+"!")},blinkTalkBar:function(){var e=this;$('.ui-dialog[aria-describedby="'+this.channel+'"] input').is(":focus")||this.blinkIntervals[this.channel]||(this.blinkEffect(),this.blinkIntervals[this.channel]=setInterval(function(){e.blinkEffect()},3e3))},hourDisplay:function(){var e=new Date,t="Godzina: "+e.getHours()+":"+e.getFullMinutes();"undefined"!=typeof this.$parent.talks[this.channel]&&this.$parent.talks[this.channel].messages.push({content:t,type:"info"})},blinkEffect:function(){$('.ui-dialog[aria-describedby="'+this.channel+'"] .ui-dialog-titlebar').effect("highlight",{},3e3)}},watch:{messages:function(e){this.closable=!0,this.scroll(),"received"==_.last(e).type&&(this.blinkTitle(),this.blinkTalkBar())}},mounted:function(){var e=this,t=!1,i=500,n=500;window.innerWidth<768&&(t=!0,i=window.innerWidth,n=window.innerHeight),$("#"+e.channel).dialog({height:n,width:i,resizable:!t,draggable:!t,open:function(){var e=$(".ui-dialog").length-1;$(this).parent().css("z-index",1030),$(this).parent().css("left",$(this).offset().left+40*e+"px"),$(this).parent().css("top",$(this).offset().top+40*e+"px")},beforeClose:function(){return e.beforeClose()},close:function(){e.close()}}).dialogExtend({closable:!0,maximizable:!t,minimizable:!0,collapsable:!1,dblclick:"minimize",titlebar:!1,minimizeLocation:"left",icons:{close:"fa fa-window-close fa-fw",maximize:"fa fa-window-maximize fa-fw",minimize:"fa fa-window-minimize fa-fw",restore:"fa fa-window-restore fa-fw"},restore:function(){e.restore()},load:function(){e.load()}}).prev(".ui-dialog-titlebar").css("background-color","#2780e3"),this.hourIntervals[this.channel]=setInterval(function(){e.hourDisplay()},3e5),$('.ui-dialog[aria-describedby="'+this.channel+'"]').not(".ui-dialog-titlebar-buttonpane").click(function(){e.activate($(this))}),this.messages[0]&&"received"==this.messages[0].type&&(this.closable=!0,this.blinkTitle(),this.blinkTalkBar())}}},function(e,t,i){"use strict";t["default"]={props:["user","self","connected"],data:function(){return{buttonText:"Rozmawiaj"}},methods:{invite:function(e){$(e.target).attr("disabled",!0),this.buttonText="Łączenie...",this.$emit("invite")}},watch:{connected:function(){this.buttonText="Rozmawiaj"}}}},function(module,exports){module.exports={render:function(){with(this)return _c("div",{staticStyle:{position:"relative"},attrs:{id:channel,title:title}},[_c("div",{staticClass:"flexbox"},[_c("div",{staticClass:"flexrow content messagebox"},_l(messages,function(e){return _c("div",["received"==e.type?_c("span",{staticClass:"message-received-photo"},[members.guest.photo?_c("img",{attrs:{src:"photos/mini/"+members.guest.photo,alt:"Zdjęcie "+members.guest.nick}}):_e(),_v(" "),members.guest.photo||0!=members.guest.gender?_e():_c("img",{attrs:{src:"images/avatar_male_mini.png",alt:"Zdjęcie "+members.guest.nick}}),_v(" "),members.guest.photo||1!=members.guest.gender?_e():_c("img",{attrs:{src:"images/avatar_female_mini.png",alt:"Zdjęcie "+members.guest.nick}})]):_e(),_v(" "),"sent"==e.type?_c("span",{staticClass:"message-sent-photo"},[members.me.photo?_c("img",{attrs:{src:"photos/mini/"+members.me.photo,alt:"Zdjęcie "+members.me.nick}}):_e(),_v(" "),members.me.photo||0!=members.me.gender?_e():_c("img",{attrs:{src:"images/avatar_male_mini.png",alt:"Zdjęcie "+members.me.nick}}),_v(" "),members.me.photo||1!=members.me.gender?_e():_c("img",{attrs:{src:"images/avatar_female_mini.png",alt:"Zdjęcie "+members.me.nick}})]):_e(),_v(" "),_c("span",{"class":"message-"+e.type},[_v(_s(e.content))])])})),_v(" "),_c("div",{staticClass:"flexrow footer"},[_c("form",{on:{submit:function(e){e.preventDefault(),send(e)}}},[_c("div",{staticClass:"input-group"},[_c("input",{directives:[{name:"model",rawName:"v-model",value:message,expression:"message"}],staticClass:"form-control",attrs:{type:"text",name:"message",maxlength:"1000",disabled:!connected,placeholder:"Wiadomość...",required:"",autocomplete:"off"},domProps:{value:_s(message)},on:{input:function(e){e.target.composing||(message=e.target.value)}}}),_v(" "),_m(0)])])])])])},staticRenderFns:[function(){with(this)return _c("span",{staticClass:"input-group-btn"},[_c("button",{staticClass:"btn btn-default",attrs:{type:"sumbit"}},[_c("i",{staticClass:"fa fa-send"})])])}]}},function(module,exports){module.exports={render:function(){with(this)return _c("div",{staticClass:"user-panel"},[user.gender?_c("i",{staticClass:"fa fa-female gender",attrs:{"aria-hidden":"true"}}):_c("i",{staticClass:"fa fa-male gender",attrs:{"aria-hidden":"true"}}),_v(" "),user.photo?_c("div",{staticClass:"photo"},[_c("img",{attrs:{src:"photos/thumbs/"+user.photo,alt:"Zdjęcie użytkownika "+user.nick}})]):_e(),_v(" "),_c("h3",{staticClass:"nick"},[_c("strong",[_v(_s(user.nick))]),_v(" "),user.age?_c("span",[_v("("+_s(user.age)+")")]):_e()]),_v(" "),user.region?_c("div",{staticClass:"region"},[_c("i",{staticClass:"fa fa-map-marker fa-fw"}),_v(" "),_c("span",[_v(_s(user.region))])]):_e(),_v(" "),user.interests?_c("div",{staticClass:"interests"},_l(user.interests,function(e,t){return _c("span",[_v(_s(e))])})):_e(),_v(" "),user.about?_c("div",{staticClass:"about"},[_v("\n        "+_s(user.about)+"\n    ")]):_e(),_v(" "),self==user.id||connected?_e():_c("div",[_c("hr"),_v(" "),_c("button",{staticClass:"invite btn btn-default btn-block",on:{click:function(e){invite(e)}}},[_v(_s(buttonText))])]),_v(" "),self!=user.id&&connected?_c("div",[_c("hr"),_v(" "),_c("button",{staticClass:"btn btn-default btn-block",attrs:{disabled:""}},[_v("Rozmowa połączona")])]):_e(),_v(" "),self==user.id?_c("div",[_c("hr")]):_e()])},staticRenderFns:[]}},function(e,t,i){function n(e,t){return e>t?"priv-"+e+"-"+t:e<t?"priv-"+t+"-"+e:void 0}function s(e,t,i,n){var s=a(e,i),r=a(e,n);return t==i?{me:e[s],guest:e[r]}:t==n?{me:e[r],guest:e[s]}:void 0}function a(e,t){return e.map(function(e){return e.id}).indexOf(t)}function r(e,t){var i=_.indexOf(e,t);e.splice(i,1)}function o(e,t){return _.indexOf(e,t)!=-1}function c(e,t){var i=!0,n=!0,s=!0,a=e.age>=t.age_min,r=e.age<=t.age_max,o=!0,c=!0,l=!0,u=!0;return""!=t.nick&&(i=e.nick.toLowerCase().includes(t.nick.toLowerCase())),$.isArray(t.region)&&t.region.length&&(n=_.indexOf(t.region,e.region)!=-1),$.isArray(t.interests)&&t.interests.length&&($.isArray(e.interests)&&e.interests.length?(s=!1,$.each(e.interests,function(e,i){var n=_.indexOf(t.interests,i)!=-1;n&&(s=!0)})):s=!1),14==t.age_min&&70==t.age_max&&(a=!0,r=!0),c=t.male?0==e.gender:1==e.gender,o=t.female?1==e.gender:0==e.gender,t.male&&t.female&&(o=!0,c=!0),t.photo&&(l=""!=e.photo&&null!=e.photo),t.about&&(u=""!=e.about&&null!=e.about),i&&n&&s&&a&&r&&o&&c&&l&&u}function l(){window.setTimeout(function(){$(".alert").fadeTo(500,0).slideUp(500),$(".delAfterAlert").fadeTo(500,0).slideUp(500)},5e3)}function u(e){e.effect("highlight",{color:"#3FB618"},1500)}Vue.component("user",i(1)),Vue.component("talk",i(0)),Vue.component("isotope",window.vueIsotope),Vue.directive("imagesLoaded",window.imagesLoaded);var f=new Vue({el:"#chat",data:{user_id:null,users:[],partners:[],talks:{},nobody:!1,filters:{}},methods:{echoGlobal:function(){var e,t,i=this,n=this;Echo.join("presence").here(function(e){i.users=e}).joining(function(n){if(n.id===e){clearTimeout(t);var s=a(i.users,n.id);i.$set(i.users,s,n)}else i.users.push(n)}).leaving(function(s){var r=a(i.users,s.id);e=s.id,t=setTimeout(function(){n.users.splice(r,1),e=null},5e3)}).listen("InvitationEvent",function(e){i.privateConnect(e.sender,e.recipient)})},echoPrivate:function(e,t,i){var n,s=this;Echo.join(e).here(function(t){"undefined"!=typeof s.talks[e]&&2==t.length&&(n=t[1].gender?"wróciła":"wrócił",s.talks[e].messages.push({content:t[1].nick+" "+n+" do rozmowy",type:"info"}))}).joining(function(t){n=t.gender?"dołączyła":"dołączył","undefined"!=typeof s.talks[e]&&s.talks[e].messages.push({content:t.nick+" "+n+" do rozmowy",type:"info"}),s.partners.push(t.id)}).leaving(function(t){n=t.gender?"opuściła":"opuścił","undefined"!=typeof s.talks[e]&&s.talks[e].messages.push({content:t.nick+" "+n+" rozmowę",type:"info"}),r(s.partners,t.id),Echo.leave(e)}).listen("MessageEvent",function(n){s.talks[e]||s.privateOpen(t,i),s.talks[e].messages.push({content:n.message,type:"received"})})},eventInvite:function(e,t){this.privateConnect(e,t),this.privateOpen(e,t),this.$http.post("/chat/invite",{sender:e,recipient:t})},privateConnect:function(e,t){var i=n(e,t);this.user_id!=e&&this.user_id!=t||(this.user_id==t&&this.partners.push(e),this.echoPrivate(i,e,t))},privateOpen:function(e,t){var i=n(e,t),a=s(this.users,this.user_id,e,t);this.user_id!=e&&this.user_id!=t||this.$set(this.talks,i,{messages:[],members:a})},privateExit:function(e,t){Echo.leave(e),this.$delete(this.talks,e),r(this.partners,t)},inArray:function(e,t){return o(e,t)},sort:function(e){this.$refs.grid.sort(e)},filter:function(e){var t=this;this.filters=e,this.$refs.grid.filter("filter"),setTimeout(function(){t.nobody=0==$(".grid .user:visible").length},400)},layout:function(){this.$refs.grid.layout("masonry")},isotopeOptions:function(){var e=this;return{sortBy:"by_nick",getSortData:{by_nick:function(e){return e.nick.toLowerCase()},by_age:function(e){return e.age}},getFilterData:{filter:function(t){return c(t,e.filters)}}}}},mounted:function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),this.user_id=$('meta[name="user-id"]').attr("content"),this.echoGlobal()}}),d=new Vue({el:"#filters",data:{sorting:"by_nick",filters:{nick:"",region:[],interests:[],age_min:14,age_max:70,female:!0,male:!0,photo:!1,about:!1},age_min:14,age_max:70},methods:{changeSorting:function(){f.sort(this.sorting)},setFilters:function(){this.filters.age_min=this.age_min,this.filters.age_max=this.age_max,f.filter(this.filters)},setMale:function(){this.filters.male=!this.filters.male,f.filter(this.filters)},setFemale:function(){this.filters.female=!this.filters.female,f.filter(this.filters)},setPhoto:function(){this.filters.photo=!this.filters.photo,f.filter(this.filters)},setAbout:function(){this.filters.about=!this.filters.about,f.filter(this.filters)}}}),h=new Vue({el:"#profile",data:{reserved:!1,changed:!1,updated:!1},methods:{update:function(){var e=this,t=new FormData(document.querySelector("#profile-form"));Echo.leave("presence"),this.$http.post("/chat/update",t).then(function(t){e.changed=!t.ok,e.updated=t.ok,u($(".side-nav")),f.echoGlobal()})},change:_.debounce(function(){this.changed=!0,this.updated=!1,this.update()},1e3),reserve:function(e){var t=this;$(e.target).valid()&&this.$http.post("/chat/reserve",new FormData(e.target)).then(function(e){t.reserved=e.ok,l()})}},mounted:function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})}});$(function(){$(".age-range").slider({range:!0,min:14,max:70,values:[14,70],slide:function(e,t){$(".age-min").text(t.values[0]),$(".age-max").text(t.values[1]),Vue.set(d,"age_min",t.values[0]),Vue.set(d,"age_max",t.values[1]),d.setFilters()}});var e;e=$(".age-input").val()>0?$(".age-input").val():null,$(".age-profile").slider({min:14,max:70,value:e,create:function(){e?($(".age-handle").html(e+' <i class="fa fa-times"></i>'),$(".age-profile .fa").click(function(){$(".age-handle").text("Wiek"),$(".age-input").val(""),h.change()})):($(".age-handle").text("Wiek"),$(".age-input").val(""))},slide:function(e,t){$(".age-handle").html(t.value+' <i class="fa fa-times"></i>'),$(".age-input").val(t.value),h.change(),$(".age-profile .fa").click(function(){$(".age-handle").text("Wiek"),$(".age-input").val(""),h.change()})}})}),$(function(){$(".button-checkbox").each(function(){function e(){var e=s.is(":checked");n.data("state",e?"on":"off"),n.find(".state-icon").removeClass().addClass("state-icon "+a[n.data("state")].icon)}function t(){e(),0==n.find(".state-icon").length&&n.prepend('<i class="state-icon '+a[n.data("state")].icon+'"></i> ')}var i=$(this),n=i.find("button"),s=i.find("input:checkbox"),a={on:{icon:"fa fa-check-square-o fa-fw"},off:{icon:"fa fa-square-o fa-fw"}};n.on("click",function(){s.prop("checked",!s.is(":checked")),s.triggerHandler("change"),e()}),s.on("change",function(){e()}),t()})}),Date.prototype.getFullMinutes=function(){return this.getMinutes()<10?"0"+this.getMinutes():this.getMinutes()};var m=!1,g=document.title,p=[document.title];newMessageTitleAlert=function(e){_.indexOf(p,e)==-1&&p.push(e);var t=0,i=function(){document.title=p[t],document.hasFocus()&&(document.title=g,p=[document.title],clearInterval(m),m=!1),t+=1,p.length<=t&&(t=0)};m||(m=setInterval(i,1e3))}}]);